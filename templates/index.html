<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width= encv, initial-scale=1.0">
    <title>CONNECT DB Online View</title>
    <style>
        table,
        td,
        th {
            /* border: 1px solid black; */
            border: 1px solid #ddd;
            font-family: Arial, Helvetica, sans-serif;
            padding: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: center;
            background-color: #adacac;
            color: black;
        }

        thead th {
            position: sticky;
            top: 0;
            /* z-index: 1; */
        }

        td {
            text-align: left;
        }

        tr:hover {
            background-color: #ddd;
        }

        /* tr:nth-child(even){background-color: #f2f2f2;} */
    </style>
</head>


<body>
    <!-- 显示软件版本信息 -->
    <div style="position: absolute; top: 10px; right: 30px; color: #888; font-size: 16px;">
    Version: {{ Version }}
</div>
    <!--输出flash调试信息-->
    <p>
        {% for message in get_flashed_messages() %}
    <h3 style="font-family:verdana;color:red">{{ message }}</h3>
    {% endfor %}
    </p>
    <p>
        <a href="{{ url_for('DBSelect') }}">返回选择数据库</a>
    </p>
    <!--表单：接收检索条件-->
    <form method="post">
        <!-- 检索的Part Type 选择-->
        <fieldset>
            <legend>Please Select the Part Type</legend>
            <P>
                <label>Part Type</label>
                <select name="tableName">
                    {% for Part_Type in Part_Type_List %}
                    <option value="{{Part_Type}}">{{Part_Type}}</option>
                    {% endfor %}
                </select>
            </P>
        </fieldset>

        <!-- 条件检索 -->
        <fieldset>
            <legend>Search by (注意:1.不要使用通配符；2:以下条件为与AND关系)</legend>
            <div style="display: flex; flex-wrap: wrap;">
                <div style="flex: 1 1 50%; min-width: 300px;">
                    <p><label>Part No:<input name="PartNo" value="{{ PartNo|default('') }}"></label></p>
                    <p><label>SAP No:<input name="SAPNo" value="{{ SAPNo|default('') }}"></label></p>
                    <p><label>SAP_Description:<input name="Description" value="{{ Description|default('') }}"></label>
                    </p>
                    <p><label>Part Value:<input name="PartValue" value="{{ PartValue|default('') }}"></label></p>

                </div>
                <div style="flex: 1 1 50%; min-width: 300px;">
                    <p><label>Manufacturer PartNum:<input name="MfcPartNum"
                                value="{{ MfcPartNum|default('') }}"></label></p>
                    <p><label>Tech Description:<input name="TechDescription"
                                value="{{ TechDescription|default('') }}"></label></p>
                    <p><label>Editor:<input name="Editor" value="{{ Editor|default('') }}"></label></p>
                    <p><label>Max Display Line:<input name="MaxLine" value="{{ MaxLine|default(1000) }}"></label></p>
                </div>
            </div>
            <div style="margin-top: 15px;">
                <input type="submit" name="btn" value="Search">
                <input type="submit" name="btn" value="SaveExcel">
            </div>
        </fieldset>
        
        <!-- AVL处理表单 -->
        <fieldset>
            <legend>SAP Number List Search (Multiple SAP Numbers separated by space, comma, or semicolon or one per line)</legend>
            <p>
                <label>Enter SAP Numbers:</label><br>
                <textarea name="SAP_Number_List" rows="4" cols="50" 
                    style="width:200px; max-width:500px; resize:vertical; overflow-y:auto;"
                    placeholder="E.g., 2TFU902013U1001, 2TFU902014U1001; 2TFU902015U1001 2TFU902016U1001">{{ SAP_Number_List|default('') }}</textarea>
            </p>
            <div style="margin-top: 15px;">
                <input type="submit" name="btn" value="SAP_Nums_Search">
                <input type="submit" name="btn" value="SaveExcel">
            </div>
        </fieldset>        
    </form>

    <!--显示检索结果-->
    <fieldset>
        <legend>Search Result:</legend>
        <p>
        <h3>Search Info: {{ Search_Info }}</h3>
        <p>
        <h3>Search Result Total Items: {{ sql_result_len }}</h3>
        </p>
        <p>
            {% if MaxLine is defined and MaxLine >= sql_result_len %}
        <h3>Display Items: {{ sql_result_len }}</h3>
        {% elif MaxLine is defined %}
        <h3>Display Items: {{ MaxLine }} (Results exceed max display line, please refine your search conditions!)</h3>
        {% else %}
        <h3>Display Items: {{ sql_result_len }}</h3>
        {% endif %}
        </p>
    </fieldset>
    <table>
        <!--表头-->
        <thead>
            <tr>
                {% for columnName in columnNameList %}
                <th>{{ columnName }}</th>
                {% endfor %}
            </tr>
        </thead>
        <!--内容-->
        <tbody>
            {% for row in sql_result %}
            {# 设置显示最大行数 #}
            {% if sql_result.index(row) < MaxLine %} {# 每行显示 #} <tr>
                {% for value in row %}
                <td>{{ value }}</td>
                {% endfor %}
                </tr>
                {% endif %}
                {% endfor %}
        </tbody>
    </table>


</body>

</html>